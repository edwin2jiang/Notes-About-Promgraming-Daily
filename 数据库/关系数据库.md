## 关系模型的数据结构

是关系

- 关系：二维表
- 属性（字段）：二维表中的列
- 域：属性的取值
- 元组（记录）：二维表中的行
- 关系模式：二维表的结构，有关系名和属性集合组成

 如：学生（学号，姓名，性别，年龄）

关系模式

	- 对关系的描述
	- 静态的、稳定的

关系

- 关系模式在某一时刻的状态或内容
- 动态的、随时间不短变化的

**关系模式和关系往往统称为关系**

## 候选码 - 主码 

候选码 - 主码 - 主属性 - 非主属性

**候选码举例：**

```
例如：在学生实体中，“学号”是能唯一的区分学生实体的，同时又假设“姓名”、“班级”的属性组合足以区分学生实体，那么{学号}和{姓名，班级}都是（超级码）候选码。
```

简单的说，候选码（超级码）就是可以被选为主码的属性或属性组。

候选码不是惟一的

而主码是唯一的

primary key (sno,cno)，此时不是有两个主码，而是主码是一个属性集，（sno,cno）

所有在候选码中的属性叫做主属性

不在任何候选码中的属性称为非主属性。

## 域 又称值域

域：又称值域。是一组具有相同数据类型的值的集合。域中所包含的值个数 成为域的**基数**。

笛卡尔积是每一个域中各分量组合的集合。

表中的每行对应一个元组，表中的每列对应一个域。

**关系是笛卡尔积的有意义的子集，也是一个二维表。**

![image-20200428162721910](C:\Users\17540\AppData\Roaming\Typora\typora-user-images\image-20200428162721910.png)

## 对关系的限定

- 关系中每个分量都是不可再分的数据项。
- 同类的数据必须是同类型，来自同一个域

- 同一关系中元组（行）不能重复

## 基本的关系操作

查询:查询的表达能力是其中最主要的部分

- 选择、投影、连接、除、并、交、差
- 选择、投影、并、差、笛卡尔积是5种基本操作
- 数据更新:插入、删除、修改

关系操作的特点

- 集合操作方式，即操作的对象和结果都是集合。称为一次一集合的方式。

## 关系数据语言的分类

**关系代数语言**
    ●用对关系的运算来表达查询要求
    ●代表: ISBL
**关系演算语言:用谓词来表达查询要求**
     ●元组关系演算语言
               ✧谓词变元的基本对象是元组变量
               ✧代表: APLHA, QUEL
     ●域关系演算语言
             ✧谓词变元的基本对象是域变量
             ✧代表: QBE
**具有关系代数和关系演算双重特点的语言**
              ●代表: SQL (Structured Query Language)

## 关系模型的完整性约束

	1. 实体完整性
 	2. 参照完整性
 	3. 用户自定义（域）完整性

### 实体完整性规则:

1. 若属性A(指一个或一-组属性)是关系R的主码，则A必须**唯---;**

2. 并且A中的每一个属性都**不能取空值**。
   例如:学生表中的学号为主码，因此输入学生的基本情况时，
   学号不能为空，也不能出现重复值。

参照完整性就是定义**外码与主码**之间的引用规则。
参照完整性规则:
若属性F是基本关系R的外码，它与基本关系S的主码K相对应，
则对于R中每个元组在F.上的值必须为:
**● 或者取空值**
**● 或者等于S中某个元组的主码值**

传统的集合运算

- 并、交、差、笛卡尔积

![J5yYSP.png](https://s1.ax1x.com/2020/04/28/J5yYSP.png)

并交差的运算要求两个关系结构一致

并 会去除重复

## 关系运算

### 选择

选择操作是从行的角度进行抽取

选择的 符号 是 σ

### 投影

投影操作是从列的角度进行抽取

投影的 符号是 π

练习

[![J5gWm8.md.png](https://s1.ax1x.com/2020/04/28/J5gWm8.md.png)](https://imgchr.com/i/J5gWm8)

  答案

[![J5RNVO.md.png](https://s1.ax1x.com/2020/04/28/J5RNVO.md.png)](https://imgchr.com/i/J5RNVO)

### 连接

先做笛卡尔积，然后在结果中选择符合条件的语句

[![J549Lq.md.png](https://s1.ax1x.com/2020/04/28/J549Lq.md.png)](https://imgchr.com/i/J549Lq)

连接的符号 ⋈

两种常用的连接

- 等值连接

[![J5o3kV.png](https://s1.ax1x.com/2020/04/28/J5o3kV.png)](https://imgchr.com/i/J5o3kV)


- 自然连接
  
  - 要自然连接，他们必须得有公共列（属性）
  - 自然连接(Natural join)是一种**特殊的等值连接**，它要求两个关系中进行比较的分量必须是**相同的属性组**，并且在结果中把**重复的属性列去掉**。而等值连接并不去掉重复的属性列。

![J5LINn.png](https://s1.ax1x.com/2020/04/28/J5LINn.png)

练习
[![J5HAFx.md.png](https://s1.ax1x.com/2020/04/28/J5HAFx.md.png)](https://imgchr.com/i/J5HAFx)

答案



练习

![J5LMm4.png](https://s1.ax1x.com/2020/04/28/J5LMm4.png)

答案 1- 4

[![J5XRoj.png](https://s1.ax1x.com/2020/04/28/J5XRoj.png)](https://imgchr.com/i/J5XRoj)

答案 5 - 8
![JId41S.png](https://s1.ax1x.com/2020/04/28/JId41S.png)



## 基本的关系运算

 **五个关系代数操作分别是：并、差、笛卡尔积、投影和选择。**

基本的关系运算不能通过其他基本运算组合推导出来

问题：连接是不是基本的关系运算？为什么

答案：不是，连接运算时通过笛卡尔积，选择、投影等基本操作组合而成的

交运算 = R - (R - S)

## 除运算

同步从行和列的角度进行运算

![JIQhS1.png](https://s1.ax1x.com/2020/04/28/JIQhS1.png)